(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[29],{

/***/ "./src/modules/orthodontic/components/records.tsx":
/*!********************************************************!*\
  !*** ./src/modules/orthodontic/components/records.tsx ***!
  \********************************************************/
/*! exports provided: OrthoRecordsPanel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OrthoRecordsPanel\", function() { return OrthoRecordsPanel; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var _common_components__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @common-components */ \"./src/common-components/index.ts\");\n/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @core */ \"./src/core/index.ts\");\n/* harmony import */ var _modules__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @modules */ \"./src/modules/index.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @utils */ \"./src/utils/index.ts\");\n/* harmony import */ var mobx__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! mobx */ \"./node_modules/mobx/lib/mobx.module.js\");\n/* harmony import */ var mobx_react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! mobx-react */ \"./node_modules/mobx-react/dist/mobx-react.module.js\");\n/* harmony import */ var office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! office-ui-fabric-react */ \"./node_modules/office-ui-fabric-react/lib/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var react_loadable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-loadable */ \"./node_modules/react-loadable/lib/index.js\");\n/* harmony import */ var react_loadable__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(react_loadable__WEBPACK_IMPORTED_MODULE_9__);\n\n\n\n\n\n\n\n\n\n\n\n\nconst EditableListComponent = react_loadable__WEBPACK_IMPORTED_MODULE_9__({\n    loading: () => react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Shimmer\"], null),\n    loader: () => tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](undefined, void 0, void 0, function* () { return (yield __webpack_require__.e(/*! import() */ 5).then(__webpack_require__.bind(null, /*! common-components/editable-list */ \"./src/common-components/editable-list.tsx\"))).EditableListComponent; })\n});\nconst viewsTerms = [\n    \"Frontal\",\n    \"Right Buccal\",\n    \"Left Buccal\",\n    \"Palatal\",\n    \"Lingual\"\n];\nlet OrthoRecordsPanel = class OrthoRecordsPanel extends react__WEBPACK_IMPORTED_MODULE_8__[\"Component\"] {\n    constructor() {\n        super(...arguments);\n        this.selectedPhotoId = \"\";\n        this.zoomedColumn = -1;\n        this.expandedField = \"\";\n        this.uploadingPhotoID = \"\";\n        this.showGrid = false;\n        this.overlayWithPrev = false;\n        this.overlayWithNext = false;\n        this.openCallouts = [];\n        this.stopObservation = function () { };\n    }\n    get canEdit() {\n        return _core__WEBPACK_IMPORTED_MODULE_2__[\"user\"].currentUser.canEditOrtho;\n    }\n    get patientAppointments() {\n        if (!this.props.orthoCase.patient) {\n            return [];\n        }\n        return this.props.orthoCase.patient.appointments\n            .map(appointment => ({\n            date: appointment.date,\n            treatmentType: (appointment.treatment || { type: \"\" }).type,\n            appointment\n        }))\n            .sort((a, b) => b.date - a.date);\n    }\n    get patientDoneAppointments() {\n        return this.patientAppointments.filter(x => x.appointment.isDone);\n    }\n    get allImages() {\n        return this.props.orthoCase.visits.reduce((all, visit) => {\n            visit.photos\n                .map(x => x.photoID)\n                .forEach(path => {\n                if (path) {\n                    all.push(path);\n                }\n            });\n            return all;\n        }, []);\n    }\n    componentDidMount() {\n        this.allImages.forEach((path) => tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function* () {\n            yield _core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"].fetchImage(path);\n        }));\n    }\n    componentWillUnmount() {\n        this.stopObservation();\n    }\n    removeImage(path) {\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function* () {\n            yield _core__WEBPACK_IMPORTED_MODULE_2__[\"files\"].remove(path);\n            return;\n        });\n    }\n    render() {\n        return (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { className: \"ortho-records\" },\n            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"SectionComponent\"], { title: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Problems`) }, this.props.orthoCase.computedProblems.length === 0 &&\n                this.props.orthoCase.problemsList.length === 0 ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBar\"], { messageBarType: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBarType\"].warning }, Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"This patient does not seem to have any problems or concerns, have you filled the case sheet?\"))) : (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"DetailsList\"], { compact: true, items: [\n                    ...[\n                        ...this.props.orthoCase.computedProblems,\n                        ...this.props.orthoCase.problemsList.map(x => Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Patient concern\") + \": \" + x)\n                    ].map((x, i) => [`${i + 1}. ${x}`])\n                ], isHeaderVisible: false, selectionMode: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"SelectionMode\"].none }))),\n            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"SectionComponent\"], { title: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Treatment Plan`) },\n                this.props.orthoCase.treatmentPlan_appliance.length ? (\"\") : (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBar\"], { messageBarType: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBarType\"].warning }, Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"A treatment plan must be before starting the treatment\"))),\n                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](EditableListComponent, { label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Add Plan`), value: this.props.orthoCase.treatmentPlan_appliance, onChange: val => {\n                        this.props.orthoCase.treatmentPlan_appliance = val;\n                    }, disabled: !this.canEdit })),\n            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"SectionComponent\"], { title: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Started/Finished`) },\n                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"Row\"], { gutter: 8 },\n                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"Col\"], { span: 12 },\n                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Toggle\"], { onText: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Started\"), offText: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Not started yet\"), checked: this.props.orthoCase.isStarted, onChange: (ev, val) => (this.props.orthoCase.isStarted = val), disabled: !this.canEdit }),\n                        this.props.orthoCase.isStarted ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Dropdown\"], { selectedKey: this.props.orthoCase.startedDate.toString(), options: this.patientDoneAppointments.map(date => {\n                                return {\n                                    key: date.date.toString(),\n                                    text: `${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"formatDate\"])(date.date, _modules__WEBPACK_IMPORTED_MODULE_3__[\"setting\"].getSetting(\"date_format\"))} ${date.treatmentType\n                                        ? `, ${date.treatmentType}`\n                                        : \"\"}`\n                                };\n                            }), disabled: !this.canEdit, onChange: (ev, newValue) => {\n                                this.props.orthoCase.startedDate = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"num\"])(newValue.key);\n                            } })) : (\"\")),\n                    \" \",\n                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"Col\"], { span: 12 },\n                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Toggle\"], { onText: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Finished\"), offText: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Not finished yet\"), checked: this.props.orthoCase.isFinished, onChange: (ev, val) => (this.props.orthoCase.isFinished = val), disabled: !this.canEdit }),\n                        this.props.orthoCase.isFinished ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Dropdown\"], { selectedKey: this.props.orthoCase.finishedDate.toString(), options: this.patientDoneAppointments.map(date => {\n                                return {\n                                    key: date.date.toString(),\n                                    text: `${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"formatDate\"])(date.date, _modules__WEBPACK_IMPORTED_MODULE_3__[\"setting\"].getSetting(\"date_format\"))} ${date.treatmentType\n                                        ? `, ${date.treatmentType}`\n                                        : \"\"}`\n                                };\n                            }), disabled: !this.canEdit, onChange: (ev, newValue) => {\n                                this.props.orthoCase.finishedDate = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"num\"])(newValue.key);\n                            } })) : (\"\")))),\n            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"SectionComponent\"], { title: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Records`) }, _core__WEBPACK_IMPORTED_MODULE_2__[\"status\"].isOnline.server ? (_core__WEBPACK_IMPORTED_MODULE_2__[\"status\"].isOnline.dropbox ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { className: \"album\" },\n                this.props.orthoCase.visits.length ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"table\", null,\n                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"tbody\", null,\n                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"tr\", null,\n                            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"td\", null),\n                            viewsTerms.map((term, index) => {\n                                if (this\n                                    .zoomedColumn !==\n                                    -1 &&\n                                    this\n                                        .zoomedColumn !==\n                                        index) {\n                                    return undefined;\n                                }\n                                else {\n                                    return (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"td\", { key: term },\n                                        this\n                                            .zoomedColumn ===\n                                            index ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"p\", { className: \"column-header\" }, viewsTerms[index])) : (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"p\", { className: \"term-initials\" }, viewsTerms[index]\n                                            .split(\" \")\n                                            .map(x => x.charAt(0))\n                                            .join(\"\"))),\n                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"br\", null),\n                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TooltipHost\"], { content: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Zoom\") },\n                                            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"IconButton\"], { iconProps: {\n                                                    iconName: this\n                                                        .zoomedColumn ===\n                                                        index\n                                                        ? \"ZoomOut\"\n                                                        : \"ZoomIn\"\n                                                }, className: \"clickable-icon\", onClick: () => {\n                                                    if (this\n                                                        .zoomedColumn ===\n                                                        index) {\n                                                        this.zoomedColumn = -1;\n                                                        return;\n                                                    }\n                                                    this.zoomedColumn = index;\n                                                } })),\n                                        this\n                                            .zoomedColumn ===\n                                            index ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TooltipHost\"], { content: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"View grid\") },\n                                            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"IconButton\"], { iconProps: {\n                                                    iconName: \"gridViewSmall\"\n                                                }, className: \"clickable-icon\", onClick: () => {\n                                                    this.showGrid = !this\n                                                        .showGrid;\n                                                } }))) : (\"\")));\n                                }\n                            }),\n                            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"td\", null)),\n                        this.props.orthoCase.visits\n                            .slice()\n                            .sort((a, b) => a.visitNumber -\n                            b.visitNumber)\n                            .map((visit, visitIndex, sortedVisits) => {\n                            const prevVisit = sortedVisits[visitIndex - 1] || new _modules__WEBPACK_IMPORTED_MODULE_3__[\"Visit\"]();\n                            const nextVisit = sortedVisits[visitIndex + 1] || new _modules__WEBPACK_IMPORTED_MODULE_3__[\"Visit\"]();\n                            return [\n                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"tr\", { key: visit.id },\n                                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"td\", null,\n                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TooltipHost\"], { content: `#${visit.visitNumber}, ${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"formatDate\"])(visit.date, _modules__WEBPACK_IMPORTED_MODULE_3__[\"setting\"].getSetting(\"date_format\"))}` },\n                                            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"IconButton\"], { id: visit.id.replace(/[0-9]/g, \"\"), iconProps: {\n                                                    iconName: \"info\"\n                                                }, onClick: () => {\n                                                    this.openCallouts.push(visit.id);\n                                                } })),\n                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Dialog\"], { onDismiss: () => {\n                                                this.openCallouts = this.openCallouts.filter(x => x !==\n                                                    visit.id);\n                                            }, hidden: this.openCallouts.indexOf(visit.id) ===\n                                                -1, className: \"visit-dialog\" },\n                                            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"DetailsList\"], { compact: true, items: [\n                                                    [\n                                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { id: \"gf-visit\" }, this\n                                                            .expandedField ===\n                                                            \"gf-visit\" ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TextField\"], { autoFocus: true, type: \"number\", label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Visit number`), value: visit.visitNumber.toString(), onBlur: () => {\n                                                                this.expandedField =\n                                                                    \"\";\n                                                            }, disabled: !this\n                                                                .canEdit, onChange: (ev, val) => {\n                                                                this.props.orthoCase.visits[visitIndex].visitNumber = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"num\"])(val);\n                                                            } })) : (`${Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Visit\")} #${visit.visitNumber}`))\n                                                    ],\n                                                    [\n                                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { id: \"gf-date\" }, this\n                                                            .expandedField ===\n                                                            \"gf-date\" ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Dropdown\"], { label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Visit date`), selectedKey: visit.date.toString(), disabled: !this\n                                                                .canEdit, options: this.patientDoneAppointments.map(date => {\n                                                                return {\n                                                                    key: date.date.toString(),\n                                                                    text: `${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"formatDate\"])(date.date, _modules__WEBPACK_IMPORTED_MODULE_3__[\"setting\"].getSetting(\"date_format\"))} ${date.treatmentType\n                                                                        ? `, ${date.treatmentType}`\n                                                                        : \"\"}`\n                                                                };\n                                                            }), onChange: (ev, newValue) => {\n                                                                this.props.orthoCase.visits[visitIndex].date = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"num\"])(newValue\n                                                                    .key);\n                                                            } })) : (`${Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Date\")}: ${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"formatDate\"])(visit.date, _modules__WEBPACK_IMPORTED_MODULE_3__[\"setting\"].getSetting(\"date_format\"))}`))\n                                                    ],\n                                                    [\n                                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { id: \"gf-appliance\" }, this\n                                                            .expandedField ===\n                                                            \"gf-appliance\" ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TextField\"], { autoFocus: true, label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Appliance`), disabled: !this\n                                                                .canEdit, value: visit.appliance, onBlur: () => {\n                                                                this.expandedField =\n                                                                    \"\";\n                                                            }, multiline: true, onChange: (ev, val) => {\n                                                                this.props.orthoCase.visits[visitIndex].appliance = val;\n                                                            } })) : (`${Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Appliance\")}: ${visit.appliance\n                                                            ? visit.appliance\n                                                            : Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"No appliance info\")}`))\n                                                    ],\n                                                    [\n                                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { id: \"gf-target\" }, this\n                                                            .expandedField ===\n                                                            \"gf-target\" ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TextField\"], { autoFocus: true, label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Target & expectations`), disabled: !this\n                                                                .canEdit, value: visit.target, onBlur: () => {\n                                                                this.expandedField =\n                                                                    \"\";\n                                                            }, multiline: true, onChange: (ev, val) => {\n                                                                this.props.orthoCase.visits[visitIndex].target = val;\n                                                            } })) : (`${Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Target & expectations\")}: ${visit.target\n                                                            ? visit.target\n                                                            : Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"No target info\")}`))\n                                                    ]\n                                                ], isHeaderVisible: false, selectionMode: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"SelectionMode\"].none, onActiveItemChanged: row => {\n                                                    this.expandedField =\n                                                        row[0].props.id;\n                                                } }))),\n                                    viewsTerms.map((term, photoIndex) => {\n                                        const photo = visit\n                                            .photos[photoIndex];\n                                        if (this\n                                            .zoomedColumn !==\n                                            -1 &&\n                                            this\n                                                .zoomedColumn !==\n                                                photoIndex) {\n                                            return undefined;\n                                        }\n                                        return (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"td\", { key: term },\n                                            this\n                                                .showGrid &&\n                                                this\n                                                    .zoomedColumn ===\n                                                    photoIndex &&\n                                                _core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                    .table[photo\n                                                    .photoID] ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"GridTableComponent\"], null)) : (\"\"),\n                                            photo.photoID ? (_core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                .table[photo\n                                                .photoID] ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { key: visit.id, className: \"photo\", onClick: () => {\n                                                    this.selectedPhotoId =\n                                                        photo.id;\n                                                } },\n                                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Icon\"], { iconName: \"MiniExpandMirrored\", className: \"hover-effect\" }),\n                                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"img\", { style: {\n                                                        width: \"100%\"\n                                                    }, src: _core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                        .table[photo\n                                                        .photoID], className: \"ortho-img-el\" }),\n                                                this\n                                                    .selectedPhotoId ===\n                                                    photo.id ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Dialog\"], { modalProps: {\n                                                        className: \"photo-dialog\"\n                                                    }, hidden: false, onDismiss: () => (this.selectedPhotoId =\n                                                        \"\") },\n                                                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { style: {\n                                                            position: \"relative\"\n                                                        } },\n                                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"img\", { style: {\n                                                                width: \"100%\"\n                                                            }, src: _core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                                .table[photo\n                                                                .photoID] }),\n                                                        this\n                                                            .overlayWithNext ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"img\", { className: \"overlay-img\", src: _core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                                .table[nextVisit\n                                                                .photos[photoIndex]\n                                                                .photoID] })) : (\"\"),\n                                                        this\n                                                            .overlayWithPrev ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"img\", { className: \"overlay-img\", src: _core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                                .table[prevVisit\n                                                                .photos[photoIndex]\n                                                                .photoID] })) : (\"\")),\n                                                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"DetailsList\"], { compact: true, items: [\n                                                            [\n                                                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { id: \"gf-visit\" }, this\n                                                                    .expandedField ===\n                                                                    \"gf-visit\" ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TextField\"], { autoFocus: true, disabled: !this\n                                                                        .canEdit, type: \"number\", label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Visit number`), value: visit.visitNumber.toString(), onBlur: () => {\n                                                                        this.expandedField =\n                                                                            \"\";\n                                                                    }, onChange: (ev, val) => {\n                                                                        this.props.orthoCase.visits[visitIndex].visitNumber = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"num\"])(val);\n                                                                    } })) : (`${Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Visit\")} #${visit.visitNumber}`))\n                                                            ],\n                                                            [\n                                                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { id: \"gf-date\" }, this\n                                                                    .expandedField ===\n                                                                    \"gf-date\" ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Dropdown\"], { label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Visit date`), disabled: !this\n                                                                        .canEdit, selectedKey: visit.date.toString(), options: this.patientDoneAppointments.map(date => {\n                                                                        return {\n                                                                            key: date.date.toString(),\n                                                                            text: `${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"formatDate\"])(date.date, _modules__WEBPACK_IMPORTED_MODULE_3__[\"setting\"].getSetting(\"date_format\"))} ${date.treatmentType\n                                                                                ? `, ${date.treatmentType}`\n                                                                                : \"\"}`\n                                                                        };\n                                                                    }), onChange: (ev, newValue) => {\n                                                                        this.props.orthoCase.visits[visitIndex].date = Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"num\"])(newValue\n                                                                            .key);\n                                                                    } })) : (`${Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Date\")}: ${Object(_utils__WEBPACK_IMPORTED_MODULE_4__[\"formatDate\"])(visit.date, _modules__WEBPACK_IMPORTED_MODULE_3__[\"setting\"].getSetting(\"date_format\"))}`))\n                                                            ],\n                                                            [\n                                                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { id: \"gf-appliance\" }, this\n                                                                    .expandedField ===\n                                                                    \"gf-appliance\" ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TextField\"], { autoFocus: true, label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Appliance`), value: visit.appliance, disabled: !this\n                                                                        .canEdit, onBlur: () => {\n                                                                        this.expandedField =\n                                                                            \"\";\n                                                                    }, multiline: true, onChange: (ev, val) => {\n                                                                        this.props.orthoCase.visits[visitIndex].appliance = val;\n                                                                    } })) : (`${Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Appliance\")}: ${visit.appliance\n                                                                    ? visit.appliance\n                                                                    : Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"No appliance info\")}`))\n                                                            ],\n                                                            [\n                                                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"div\", { id: \"gf-comment\" }, this\n                                                                    .expandedField ===\n                                                                    \"gf-comment\" ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TextField\"], { autoFocus: true, label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Comment`), disabled: !this\n                                                                        .canEdit, value: photo.comment, onBlur: () => {\n                                                                        this.expandedField =\n                                                                            \"\";\n                                                                    }, multiline: true, onChange: (ev, val) => {\n                                                                        this.props.orthoCase.visits[visitIndex].photos[photoIndex].comment = val;\n                                                                    } })) : (`${Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Comment\")}: ${photo.comment\n                                                                    ? photo.comment\n                                                                    : Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"no comment on this photo\")}`))\n                                                            ]\n                                                        ], isHeaderVisible: false, selectionMode: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"SelectionMode\"].none, onActiveItemChanged: row => {\n                                                            this.expandedField =\n                                                                row[0].props.id;\n                                                        } }),\n                                                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"CommandBar\"], { items: [\n                                                            {\n                                                                key: \"overlay prev\",\n                                                                text: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Overlay prev\"),\n                                                                iconProps: {\n                                                                    iconName: \"MapLayers\"\n                                                                },\n                                                                className: this\n                                                                    .overlayWithPrev\n                                                                    ? \"active-button\"\n                                                                    : undefined,\n                                                                onClick: () => {\n                                                                    this.overlayWithPrev = !this\n                                                                        .overlayWithPrev;\n                                                                },\n                                                                hidden: !_core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                                    .table[prevVisit\n                                                                    .photos[photoIndex]\n                                                                    .photoID]\n                                                            },\n                                                            {\n                                                                key: \"overlay next\",\n                                                                text: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Overlay next\"),\n                                                                iconProps: {\n                                                                    iconName: \"MapLayers\"\n                                                                },\n                                                                className: this\n                                                                    .overlayWithNext\n                                                                    ? \"active-button\"\n                                                                    : undefined,\n                                                                onClick: () => {\n                                                                    this.overlayWithNext = !this\n                                                                        .overlayWithNext;\n                                                                },\n                                                                hidden: !_core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                                    .table[nextVisit\n                                                                    .photos[photoIndex]\n                                                                    .photoID]\n                                                            }\n                                                        ], farItems: [\n                                                            {\n                                                                key: \"delete photo\",\n                                                                text: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Delete\"),\n                                                                iconProps: {\n                                                                    iconName: \"trash\"\n                                                                },\n                                                                disabled: !this\n                                                                    .canEdit,\n                                                                onClick: () => {\n                                                                    this.removeImage(this\n                                                                        .props\n                                                                        .orthoCase\n                                                                        .visits[visitIndex]\n                                                                        .photos[photoIndex]\n                                                                        .photoID);\n                                                                    this.props.orthoCase.visits[visitIndex].photos[photoIndex] = new _modules__WEBPACK_IMPORTED_MODULE_3__[\"Photo\"]();\n                                                                    this.selectedPhotoId =\n                                                                        \"\";\n                                                                }\n                                                            }\n                                                        ] }))) : (\"\"))) : (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"Icon\"], { iconName: \"sync\", className: \"rotate\" }))) : (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"PickAndUploadComponent\"], Object.assign({}, {\n                                                crop: true,\n                                                allowMultiple: false,\n                                                accept: _common_components__WEBPACK_IMPORTED_MODULE_1__[\"fileTypes\"].image,\n                                                prevSrc: _core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"]\n                                                    .table[prevVisit\n                                                    .photos[photoIndex]\n                                                    .photoID],\n                                                disabled: !this\n                                                    .canEdit,\n                                                onFinish: e => {\n                                                    if (e[0]) {\n                                                        this.props.orthoCase.visits[visitIndex].photos[photoIndex].photoID =\n                                                            e[0];\n                                                        _core__WEBPACK_IMPORTED_MODULE_2__[\"imagesTable\"].fetchImage(e[0]);\n                                                    }\n                                                },\n                                                onStartLoading: () => {\n                                                    this.uploadingPhotoID =\n                                                        photo.id;\n                                                },\n                                                onFinishLoading: () => {\n                                                    this.uploadingPhotoID =\n                                                        \"\";\n                                                },\n                                                targetDir: `${_core__WEBPACK_IMPORTED_MODULE_2__[\"ORTHO_RECORDS_DIR\"]}/${this\n                                                    .props\n                                                    .orthoCase\n                                                    ._id}`\n                                            }),\n                                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TooltipHost\"], { content: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Add photo\") },\n                                                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"IconButton\"], { iconProps: {\n                                                            iconName: \"Photo2Add\"\n                                                        }, className: \"clickable-icon add-photo\", disabled: !this\n                                                            .canEdit }))))));\n                                    }),\n                                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"td\", null,\n                                        react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"TooltipHost\"], { content: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Delete visit\") },\n                                            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"IconButton\"], { className: \"clickable-icon delete-visit\", key: visit.id, disabled: !this\n                                                    .canEdit, iconProps: {\n                                                    iconName: \"DeleteRows\"\n                                                }, onClick: () => {\n                                                    _core__WEBPACK_IMPORTED_MODULE_2__[\"modals\"].newModal({\n                                                        text: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"This visit data will be deleted along with all photos and notes\"),\n                                                        onConfirm: () => {\n                                                            const deletedVisit = this.props.orthoCase.visits.splice(visitIndex, 1);\n                                                            deletedVisit[0].photos.forEach(photo => this.removeImage(photo.photoID));\n                                                        },\n                                                        showCancelButton: true,\n                                                        showConfirmButton: true,\n                                                        id: Math.random()\n                                                    });\n                                                } })))),\n                                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"tr\", { key: visit.id +\n                                        \"days\" },\n                                    react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"td\", { colSpan: 7 }, sortedVisits[visitIndex +\n                                        1] ? (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"i\", { className: \"days-num\" },\n                                        Math.round((nextVisit.date -\n                                            visit.date) /\n                                            _utils__WEBPACK_IMPORTED_MODULE_4__[\"day\"]),\n                                        \" \",\n                                        Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"days\"))) : (\"\")))\n                            ];\n                        })))) : (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBar\"], { messageBarType: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBarType\"].info }, Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"No visits recorded yet! add a new visit using the button below\"))),\n                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](\"br\", null),\n                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"DefaultButton\"], { disabled: !this.canEdit, iconProps: { iconName: \"ExploreContent\" }, text: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"Add visit\"), onClick: () => {\n                        const visitNumber = this.props.orthoCase\n                            .visits.length\n                            ? this.props.orthoCase.visits\n                                .slice()\n                                .sort((a, b) => b.visitNumber -\n                                a.visitNumber)[0].visitNumber + 1\n                            : 1;\n                        this.props.orthoCase.visits.push(new _modules__WEBPACK_IMPORTED_MODULE_3__[\"Visit\"]().withVisitNumber(visitNumber));\n                    } }))) : (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBar\"], { messageBarType: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBarType\"].warning }, Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"A valid DropBox access token is required for this section\")))) : (react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBar\"], { messageBarType: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__[\"MessageBarType\"].warning }, Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(\"You can not access orthodontic records while offline\")))),\n            react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](_common_components__WEBPACK_IMPORTED_MODULE_1__[\"SectionComponent\"], { title: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Notes for the next visit`) },\n                react__WEBPACK_IMPORTED_MODULE_8__[\"createElement\"](EditableListComponent, { label: Object(_core__WEBPACK_IMPORTED_MODULE_2__[\"text\"])(`Add note`), value: this.props.orthoCase.nextVisitNotes, onChange: val => {\n                        this.props.orthoCase.nextVisitNotes = val;\n                    }, disabled: !this.canEdit }))));\n    }\n};\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"observable\"]\n], OrthoRecordsPanel.prototype, \"selectedPhotoId\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"observable\"]\n], OrthoRecordsPanel.prototype, \"zoomedColumn\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"observable\"]\n], OrthoRecordsPanel.prototype, \"expandedField\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"observable\"]\n], OrthoRecordsPanel.prototype, \"uploadingPhotoID\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"observable\"]\n], OrthoRecordsPanel.prototype, \"showGrid\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"observable\"]\n], OrthoRecordsPanel.prototype, \"overlayWithPrev\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"observable\"]\n], OrthoRecordsPanel.prototype, \"overlayWithNext\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"observable\"]\n], OrthoRecordsPanel.prototype, \"openCallouts\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"computed\"]\n], OrthoRecordsPanel.prototype, \"canEdit\", null);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"computed\"]\n], OrthoRecordsPanel.prototype, \"patientAppointments\", null);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"computed\"]\n], OrthoRecordsPanel.prototype, \"patientDoneAppointments\", null);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_5__[\"computed\"]\n], OrthoRecordsPanel.prototype, \"allImages\", null);\nOrthoRecordsPanel = tslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx_react__WEBPACK_IMPORTED_MODULE_6__[\"observer\"]\n], OrthoRecordsPanel);\n\n\n\n//# sourceURL=webpack:///./src/modules/orthodontic/components/records.tsx?");

/***/ })

}]);