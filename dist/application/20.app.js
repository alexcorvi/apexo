(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[20],{

/***/ "./src/main-components/login.tsx":
/*!***************************************!*\
  !*** ./src/main-components/login.tsx ***!
  \***************************************/
/*! exports provided: LoginView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LoginView\", function() { return LoginView; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @core */ \"./src/core/index.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @utils */ \"./src/utils/index.ts\");\n/* harmony import */ var mobx__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! mobx */ \"./node_modules/mobx/lib/mobx.module.js\");\n/* harmony import */ var mobx_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! mobx-react */ \"./node_modules/mobx-react/dist/mobx-react.module.js\");\n/* harmony import */ var office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! office-ui-fabric-react */ \"./node_modules/office-ui-fabric-react/lib/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n\nlet LoginView = class LoginView extends react__WEBPACK_IMPORTED_MODULE_6__[\"Component\"] {\n    constructor() {\n        super(...arguments);\n        this.usernameFieldValue = \"\";\n        this.passwordFieldValue = \"\";\n        this.serverFieldValue = window.couchDBServer ||\n            _utils__WEBPACK_IMPORTED_MODULE_2__[\"store\"].get(\"server_location\") ||\n            location.origin.replace(/:\\d+$/g, \":5984\");\n        this.errorMessage = \"\";\n        this.disableInputs = false;\n        this.step = 1;\n        this.editServerLocation = false;\n        this.initiallyChecked = false;\n    }\n    get impossibleToLogin() {\n        return (!_core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].isOnline.server &&\n            !_core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].isOnline.client &&\n            !_utils__WEBPACK_IMPORTED_MODULE_2__[\"store\"].found(\"LSL_hash\"));\n    }\n    componentDidMount() {\n        _core__WEBPACK_IMPORTED_MODULE_1__[\"status\"]\n            .initialCheck(this.serverFieldValue)\n            .finally(() => (this.initiallyChecked = true));\n    }\n    login(offline) {\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function* () {\n            if (!(this.usernameFieldValue &&\n                this.passwordFieldValue &&\n                this.serverFieldValue)) {\n                this.errorMessage = \"All fields are necessary\";\n                return;\n            }\n            this.errorMessage = \"\";\n            const result = offline\n                ? yield _core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].loginWithCredentialsOffline({\n                    username: this.usernameFieldValue,\n                    password: this.passwordFieldValue,\n                    server: this.serverFieldValue.replace(/([^\\/])\\/[^\\/].+/, \"$1\")\n                })\n                : yield _core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].loginWithCredentials({\n                    username: this.usernameFieldValue,\n                    password: this.passwordFieldValue,\n                    server: this.serverFieldValue.replace(/([^\\/])\\/[^\\/].+/, \"$1\")\n                });\n            if (typeof result !== \"boolean\") {\n                this.errorMessage = result;\n            }\n        });\n    }\n    render() {\n        return (react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"div\", { className: \"login-component\" }, this.impossibleToLogin ? (react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"div\", { \"data-testid\": \"impossible\" },\n            react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"MessageBar\"], { messageBarType: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"MessageBarType\"].error },\n                \"You're offline and unable to login\",\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"br\", null)),\n            react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"DefaultButton\"], { text: \"Reload\", className: \"m-t-15 m-b-15 m-r-5\", onClick: () => {\n                    location.reload();\n                }, iconProps: {\n                    iconName: \"Sync\"\n                } }),\n            react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"DefaultButton\"], { text: \"no-server mode\", className: \"no-server-mode\", onClick: () => {\n                    _core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].startNoServer();\n                }, iconProps: {\n                    iconName: \"StatusErrorFull\"\n                } }))) : (react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"div\", { className: \"login-forum\" },\n            this.initiallyChecked ? (react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"div\", { className: \"login-step\" },\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"div\", { className: _core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].isOnline.server\n                        ? \"hidden\"\n                        : \"offline-msg\" },\n                    react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"MessageBar\"], { messageBarType: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"MessageBarType\"].warning }, `${Object(_core__WEBPACK_IMPORTED_MODULE_1__[\"text\"])(`You're offline. Use the latest username/password you've successfully used on this machine to login to this server`)}:\n\t\t\t\t\t\t\t\t${(this.serverFieldValue || \"\").replace(/([^\\/])\\/[^\\/].+/, \"$1\")}.\n\t\t\t\t\t\t\t`)),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"br\", null),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"hr\", null),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"div\", { className: _core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].isOnline.server ? \"\" : \"hidden\" },\n                    react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"div\", { style: {\n                            display: \"inline-block\",\n                            width: \"75%\"\n                        } },\n                        react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"TextField\"], { name: \"server\", label: Object(_core__WEBPACK_IMPORTED_MODULE_1__[\"text\"])(`Server location`), value: this.serverFieldValue, disabled: this.disableInputs ||\n                                !this.editServerLocation, onChange: (ev, v) => (this.serverFieldValue = v), className: \"input-server\" })),\n                    react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"DefaultButton\"], { className: \"edit-server-location\", onClick: () => {\n                            this.editServerLocation = true;\n                        } }, \"Change\")),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"br\", null),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"br\", null),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](\"hr\", null),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"TextField\"], { name: \"identification\", label: Object(_core__WEBPACK_IMPORTED_MODULE_1__[\"text\"])(`Username`), disabled: this.disableInputs, value: this.usernameFieldValue, onChange: (e, v) => (this.usernameFieldValue = v), \"data-testid\": \"input-identification\", onKeyDown: ev => {\n                        if (ev.keyCode === 13) {\n                            this.login();\n                        }\n                    } }),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"TextField\"], { name: \"password\", type: \"Password\", label: Object(_core__WEBPACK_IMPORTED_MODULE_1__[\"text\"])(`Password`), disabled: this.disableInputs, value: this.passwordFieldValue, onChange: (e, v) => (this.passwordFieldValue = v), \"data-testid\": \"input-password\", onKeyDown: ev => {\n                        if (ev.keyCode === 13) {\n                            this.login();\n                        }\n                    } }),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"PrimaryButton\"], { iconProps: {\n                        iconName: \"Permissions\"\n                    }, text: Object(_core__WEBPACK_IMPORTED_MODULE_1__[\"text\"])(\"Login\"), disabled: this.disableInputs, className: \"m-t-15 m-b-15\", \"data-testid\": \"proceed-primary\", onClick: () => {\n                        this.login();\n                    } }),\n                _core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].tryOffline ? (react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"PrimaryButton\"], { text: Object(_core__WEBPACK_IMPORTED_MODULE_1__[\"text\"])(\"Access offline\"), disabled: this.disableInputs, className: \"m-t-15 m-b-15 m-l-5 m-r-5\", \"data-testid\": \"proceed-offline\", onClick: () => {\n                        this.login(true);\n                    } })) : (\"\"),\n                react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"DefaultButton\"], { onClick: _core__WEBPACK_IMPORTED_MODULE_1__[\"status\"].startNoServer, className: \"no-server-mode\", iconProps: {\n                        iconName: \"StatusErrorFull\"\n                    } }, \"no-server mode\"))) : (\"\"),\n            this.errorMessage ? (react__WEBPACK_IMPORTED_MODULE_6__[\"createElement\"](office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"MessageBar\"], { \"data-testid\": \"error-msg\", messageBarType: office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__[\"MessageBarType\"].error }, this.errorMessage)) : (\"\")))));\n    }\n};\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"observable\"]\n], LoginView.prototype, \"usernameFieldValue\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"observable\"]\n], LoginView.prototype, \"passwordFieldValue\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"observable\"]\n], LoginView.prototype, \"serverFieldValue\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"observable\"]\n], LoginView.prototype, \"errorMessage\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"observable\"]\n], LoginView.prototype, \"disableInputs\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"observable\"]\n], LoginView.prototype, \"step\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"observable\"]\n], LoginView.prototype, \"editServerLocation\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"observable\"]\n], LoginView.prototype, \"initiallyChecked\", void 0);\ntslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx__WEBPACK_IMPORTED_MODULE_3__[\"computed\"]\n], LoginView.prototype, \"impossibleToLogin\", null);\nLoginView = tslib__WEBPACK_IMPORTED_MODULE_0__[\"__decorate\"]([\n    mobx_react__WEBPACK_IMPORTED_MODULE_4__[\"observer\"]\n], LoginView);\n\n\n\n//# sourceURL=webpack:///./src/main-components/login.tsx?");

/***/ })

}]);